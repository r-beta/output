# 達人に学ぶDB設計徹底指南書
## 第1章 データベースを制するものはシステムを制す
- データ中心アプローチ(DOA)とプロセス中心アプローチ(POA)があり、POAは時代遅れになっている。
- 3層スキーマモデル
    - 外部スキーマ: ビューの世界
    - 概念スキーマ: テーブルの世界
    - 内部スキーマ: ファイルの世界

## 第2章 論理設計と物理設計
- 論理設計→物理設計の順
### 2-1　概念スキーマと論理設計
- 論理設計のステップ
    1. エンティティの抽出
    1. エンティティの定義
    1. 正規化
    1. ER図の作成

### 2-2.内部スキーマと物理設計
- 物理設計のステップ
    1. テーブル定義
    1. インデックス定義
    1. ハードウェアのサイジング
    1. ストレージの冗長構成
    1. ファイルの物理配置決定
- サイジングはキャパシティとパフォーマンスの2つの観点から行う。
- データベースの性能問題の8割はディスクI/Oによって起こる。DB
- データの整合性とパフォーマンスは強いトレードオフがある。
- サイジングをするにあたり、以下の入力情報が必要
    - キャパシティのサイジング
        - システムで利用するデータ量
        - サービス終了時のデータ増加率
    - パフォーマンスのサイジング
        - 性能要件
            - 処理時間(何秒以内時終了するか)
            - スループット(単位時間あたりにどれだけの処理をこなせるか)
        - リソース使用量の基礎数値->これは机上では見えにくいので、以下の方法で得る
            - 類似システムから推測する
            - プロトタイプシステムを構築して性能検証する
- **精度の高いサイジングは難しいので以下の2点を心がけることが大事**
    - 必ず実施時に安全率をかける
    - スケーラビリティの高い構成を組むこと


### 2-4.リカバリ設計
- リストアとリカバリの違
    - リストア: バックアップファイルを戻す作業
    - リカバリ: そのバックアップファイルに対してトランザクションログを適用して変更分を反映すること
- 重要なのはリカバリの方
- DB障害発生復旧の手順
    1. フルバックアップのファイルをデータベースに戻す(リストア)
    1. 差分(または増分)バックアップしていたトランザクションログを適用する。(リカバリ)
    1. データベースサーバーに残っているトランザクションログを適用する。(ロールフォワード)
- DBサーバーのクラスタリング構成
    - スタンドアロン(冗長性がないのでまず採用されない)
    - ActiveStandby方式(サーバー2台で片方が予備)→性能はスタンドアロンと変わらない
        - ホットスタンバイ(復旧早いけど、光熱費とかライセンス日が余分にかかる恐れ)
        - コールドスタンバイ(復旧遅いけど、安い)
    - ActiveActive方式(複数サーバーを現用系で稼働)
        - シェアードディスク(ディスクを共有、他リソースは別)→ディスクを共有しているので性能頭打ち似鳴子tが多い
        - シェアードナッシング(全リソース別)

## 第3章 論理設計と正規化～なぜテーブルは分割する必要があるのか?
### 3-1.テーブルとは何か？
- テーブル名は英語ならば複数形／複数名詞で書ける。そうでなければそのテーブルにはどこか間違いがある。
### 3-2.テーブルの構成要素
- (個人的反省)キーとカラムをごっちゃに話してしまった事があるんので気をつける
- 外部キーが設定されている場合、データの削除は子から順に操作するのが吉。
- テーブル定義において、列には可能な限りNOTNULL制約を付加する。

### 3-3.正規かとは何か？
- 正規形のレベルは第5まであるが、普通は第3正規形まで理解すれば十分。

### 3-4.第1正規形
- 第1正規形の定義とは「一つのセルの中には一つの値しか含まない」

### 3-5.第2正規形~部分関数従属
- 第2正規形は、部分関数従属を解消することで得られる。言葉より例を見ないと分かりにくい
- 第2正規化は可逆的
